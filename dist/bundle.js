!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.fsmx=e():t.fsmx=e()}(window,(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function s(t){try{a(i.next(t))}catch(t){r(t)}}function u(t){try{a(i.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}a((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const o="No initial state defined",r="Initial state should be string",s="No actions defined",u="Can't transit to target";e.default=class{constructor(t){if(this.state=null,!t.initial)throw new Error(o);if("string"!=typeof t.initial)throw new TypeError(r);if(!t.actions||!Object.keys(t.actions).length)throw new Error(s);this.initial=t.initial,this.state=this.initial,this.events=t.events,this.schema=[],this.buildSchema(t.actions)}transit(t,e){return i(this,void 0,void 0,(function*(){if(!this.can(e))throw new Error(u);yield this.emit("onLeaveState",t,e),this.state=e,yield this.emit("onEnterState",t,e)}))}emit(t,...e){return i(this,void 0,void 0,(function*(){"function"==typeof this.events[t]&&(yield this.events[t](...e))}))}buildSchema(t){Object.keys(t).forEach(e=>{this.schema.push({from:t[e].from,to:t[e].to}),this[e]=()=>i(this,void 0,void 0,(function*(){yield this.transit(t[e].from,t[e].to)}))})}can(t){return!!this.schema.find(e=>{const n="string"==typeof e.from?e.from===this.state:e.from.includes(this.state),i=e.to===t;return n&&i})}is(t){return this.state===t}reset(){this.state=this.initial}}}])}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9mc214L3dlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIndlYnBhY2s6Ly9mc214L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2ZzbXgvLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwid2luZG93IiwiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImVycm9ycyIsIm9wdGlvbnMiLCJzdGF0ZSIsImluaXRpYWwiLCJFcnJvciIsIlR5cGVFcnJvciIsImFjdGlvbnMiLCJrZXlzIiwibGVuZ3RoIiwidGhpcyIsImV2ZW50cyIsInNjaGVtYSIsImJ1aWxkU2NoZW1hIiwiZnJvbSIsInRvIiwiY2FuIiwiZW1pdCIsImV2ZW50IiwicGFyYW1zIiwiZm9yRWFjaCIsImFjdGlvbiIsInB1c2giLCJ0cmFuc2l0Iiwic3RhdGVOYW1lIiwiZmluZCIsImZyb21NYXRjaCIsImluY2x1ZGVzIiwidG9NYXRjaCJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBMkNBLEVBQU1DLEdBQzFCLGlCQUFaQyxTQUEwQyxpQkFBWEMsT0FDeENBLE9BQU9ELFFBQVVELElBQ1EsbUJBQVhHLFFBQXlCQSxPQUFPQyxJQUM5Q0QsT0FBTyxHQUFJSCxHQUNlLGlCQUFaQyxRQUNk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QyxHLHlDQUNGLG1CQUF2QlQsS0FBS0MsT0FBT08sV0FDZlIsS0FBS0MsT0FBT08sTUFBVUMsT0FJeEIsWUFBYVosR0FDbkI1QixPQUFPNkIsS0FBS0QsR0FBU2EsUUFBUUMsSUFDM0JYLEtBQUtFLE9BQU9VLEtBQUssQ0FDZlIsS0FBTVAsRUFBUWMsR0FBUVAsS0FDdEJDLEdBQUlSLEVBQVFjLEdBQVFOLEtBR3RCTCxLQUFLVyxHQUFVLElBQVksRUFBRCxzQ0FDbEJYLEtBQUthLFFBQVFoQixFQUFRYyxHQUFRUCxLQUFNUCxFQUFRYyxHQUFRTixTQUt4RCxJQUFLUyxHQU9WLFFBTmNkLEtBQUtFLE9BQU9hLEtBQUt6QixJQUM3QixNQUFNMEIsRUFBOEIsaUJBQVgxQixFQUFFYyxLQUFvQmQsRUFBRWMsT0FBU0osS0FBS1AsTUFBUUgsRUFBRWMsS0FBS2EsU0FBU2pCLEtBQUtQLE9BQ3RGeUIsRUFBVTVCLEVBQUVlLEtBQU9TLEVBQ3pCLE9BQU9FLEdBQWFFLElBTWpCLEdBQUlKLEdBQ1QsT0FBT2QsS0FBS1AsUUFBVXFCLEVBR2pCLFFBQ0xkLEtBQUtQLE1BQVFPLEtBQUtOIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcImZzbXhcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wiZnNteFwiXSA9IGZhY3RvcnkoKTtcbn0pKHdpbmRvdywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwidHlwZSBGc214RXZlbnQgPSAoZnJvbTogc3RyaW5nLCB0bzogc3RyaW5nKSA9PiB2b2lkXG5cbmludGVyZmFjZSBJRnNteEV2ZW50cyB7XG4gIG9uTGVhdmVTdGF0ZT86IEZzbXhFdmVudFxuICBvbkVudGVyU3RhdGU/OiBGc214RXZlbnRcbn1cblxuaW50ZXJmYWNlIElGc214U2NoZW1hSXRlbSB7XG4gIGZyb206IHN0cmluZyB8IHN0cmluZ1tdXG4gIHRvOiBzdHJpbmdcbn1cblxudHlwZSBGc214SW5pdGlhbFN0YXRlID0gc3RyaW5nXG50eXBlIEZzbXhBY3Rpb25zID0ge1xuICBba2V5OiBzdHJpbmddOiB7IGZyb206IHN0cmluZyB8IHN0cmluZ1tdLCB0bzogc3RyaW5nIH1cbn1cblxuaW50ZXJmYWNlIEZzbXhJbml0aWFsT3B0aW9ucyB7XG4gIGluaXRpYWw6IEZzbXhJbml0aWFsT3B0aW9uc1xuICBhY3Rpb25zOiBGc214QWN0aW9uc1xuICBldmVudHM/OiBJRnNteEV2ZW50c1xufVxuXG5jb25zdCBlcnJvcnMgPSB7XG4gIG5vSW5pdGlhbFN0YXRlOiAnTm8gaW5pdGlhbCBzdGF0ZSBkZWZpbmVkJyxcbiAgaW52YWxpZFR5cGVPZlN0YXRlOiAnSW5pdGlhbCBzdGF0ZSBzaG91bGQgYmUgc3RyaW5nJyxcbiAgbm9BY3Rpb25zOiAnTm8gYWN0aW9ucyBkZWZpbmVkJyxcbiAgY2FudFRyYW5zaXQ6ICdDYW5cXCd0IHRyYW5zaXQgdG8gdGFyZ2V0J1xufVxuXG5jbGFzcyBGc214IHtcbiAgaW5pdGlhbDogRnNteEluaXRpYWxTdGF0ZVxuICBldmVudHM6IElGc214RXZlbnRzXG4gIHNjaGVtYTogSUZzbXhTY2hlbWFJdGVtW11cblxuICBzdGF0ZTogc3RyaW5nID0gbnVsbFxuXG4gIGNvbnN0cnVjdG9yIChvcHRpb25zOiBGc214SW5pdGlhbE9wdGlvbnMpIHtcbiAgICBpZiAoIW9wdGlvbnMuaW5pdGlhbCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9ycy5ub0luaXRpYWxTdGF0ZSlcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIG9wdGlvbnMuaW5pdGlhbCAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoZXJyb3JzLmludmFsaWRUeXBlT2ZTdGF0ZSlcbiAgICB9XG5cbiAgICBpZiAoIW9wdGlvbnMuYWN0aW9ucyB8fCAhT2JqZWN0LmtleXMob3B0aW9ucy5hY3Rpb25zKS5sZW5ndGgpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcnMubm9BY3Rpb25zKVxuICAgIH1cblxuICAgIHRoaXMuaW5pdGlhbCA9IG9wdGlvbnMuaW5pdGlhbFxuICAgIHRoaXMuc3RhdGUgPSB0aGlzLmluaXRpYWxcbiAgICB0aGlzLmV2ZW50cyA9IG9wdGlvbnMuZXZlbnRzXG4gICAgdGhpcy5zY2hlbWEgPSBbXVxuXG4gICAgdGhpcy5idWlsZFNjaGVtYShvcHRpb25zLmFjdGlvbnMpXG4gIH1cblxuICBwdWJsaWMgYXN5bmMgdHJhbnNpdCAoZnJvbTogc3RyaW5nIHwgc3RyaW5nW10sIHRvOiBzdHJpbmcpIHtcbiAgICBpZiAodGhpcy5jYW4odG8pKSB7XG4gICAgICBhd2FpdCB0aGlzLmVtaXQoJ29uTGVhdmVTdGF0ZScsIGZyb20sIHRvKVxuICAgICAgdGhpcy5zdGF0ZSA9IHRvXG4gICAgICBhd2FpdCB0aGlzLmVtaXQoJ29uRW50ZXJTdGF0ZScsIGZyb20sIHRvKVxuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JzLmNhbnRUcmFuc2l0KVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZW1pdCAoZXZlbnQ6IHN0cmluZywgLi4ucGFyYW1zOiBhbnkpIHtcbiAgICBpZiAodHlwZW9mIHRoaXMuZXZlbnRzW2V2ZW50XSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgYXdhaXQgdGhpcy5ldmVudHNbZXZlbnRdKC4uLnBhcmFtcylcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGJ1aWxkU2NoZW1hIChhY3Rpb25zOiBGc214QWN0aW9ucykge1xuICAgIE9iamVjdC5rZXlzKGFjdGlvbnMpLmZvckVhY2goYWN0aW9uID0+IHtcbiAgICAgIHRoaXMuc2NoZW1hLnB1c2goe1xuICAgICAgICBmcm9tOiBhY3Rpb25zW2FjdGlvbl0uZnJvbSxcbiAgICAgICAgdG86IGFjdGlvbnNbYWN0aW9uXS50b1xuICAgICAgfSlcblxuICAgICAgdGhpc1thY3Rpb25dID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICBhd2FpdCB0aGlzLnRyYW5zaXQoYWN0aW9uc1thY3Rpb25dLmZyb20sIGFjdGlvbnNbYWN0aW9uXS50bylcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgcHVibGljIGNhbiAoc3RhdGVOYW1lOiBzdHJpbmcpIHtcbiAgICBjb25zdCBmb3VuZCA9IHRoaXMuc2NoZW1hLmZpbmQocyA9PiB7XG4gICAgICBjb25zdCBmcm9tTWF0Y2ggPSB0eXBlb2Ygcy5mcm9tID09PSAnc3RyaW5nJyA/IHMuZnJvbSA9PT0gdGhpcy5zdGF0ZSA6IHMuZnJvbS5pbmNsdWRlcyh0aGlzLnN0YXRlKVxuICAgICAgY29uc3QgdG9NYXRjaCA9IHMudG8gPT09IHN0YXRlTmFtZVxuICAgICAgcmV0dXJuIGZyb21NYXRjaCAmJiB0b01hdGNoXG4gICAgfSlcblxuICAgIHJldHVybiBmb3VuZCA/IHRydWUgOiBmYWxzZVxuICB9XG5cbiAgcHVibGljIGlzIChzdGF0ZU5hbWU6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLnN0YXRlID09PSBzdGF0ZU5hbWVcbiAgfVxuXG4gIHB1YmxpYyByZXNldCAoKSB7XG4gICAgdGhpcy5zdGF0ZSA9IHRoaXMuaW5pdGlhbFxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEZzbXhcbiJdLCJzb3VyY2VSb290IjoiIn0=