!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.fsmx=e():t.fsmx=e()}(global,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=1)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(r,n,o){var i=o.value;return"function"==typeof i&&(o.value=function(){for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];e&&console.log("Arguments for "+t+": "+o);try{var u=i.apply(r,o);return e&&console.log("Result from "+t+": "+u),u}catch(r){throw e&&console.log("Error from "+t+": "+r),r}}),o}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=r(0),a=(n=i)&&n.__esModule?n:{default:n};function u(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}function c(t,e,r,n,o){var i={};return Object.keys(n).forEach(function(t){i[t]=n[t]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce(function(r,n){return n(t,e,r)||r},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null),i}function s(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,r){return function n(o,i){try{var a=e[o](i),u=a.value}catch(t){return void r(t)}if(!a.done)return Promise.resolve(u).then(function(t){n("next",t)},function(t){n("throw",t)});t(u)}("next")})}}e.default=function(t){var e,r,n,i,f,p,l,y=t.initial,v=t.actions,d=t.events,h=void 0===d?{}:d,m=t.log,b=void 0!==m&&m;if(!y)throw new Error("No initial state defined");if("string"!=typeof y)throw new TypeError("Initial state should be string");if(!v)throw new Error("No actions defined");return new(e=(0,a.default)("transit",b),r=(0,a.default)("emit",b),n=(0,a.default)("can",b),i=(0,a.default)("is",b),f=(0,a.default)("reset",b),function(t){var e=this;return t.prototype.initial=y,t.prototype.state=y,t.prototype.events=h,t.prototype.schema=[],Object.keys(v).forEach(function(r){t.prototype.schema.push({from:v[r].from,to:v[r].to}),t.prototype[r]=s(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.prototype._transit(v[r].from,v[r].to);case 2:case"end":return e.stop()}},n,e)}))}),function(){return new t}}((c((l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return o(t,[{key:"_transit",value:function(){var t=s(regeneratorRuntime.mark(function t(e,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.can(r)){t.next=8;break}return t.next=3,this._emit("onLeaveState",e,r);case 3:return this.state=r,t.next=6,this._emit("onEnterState",e,r);case 6:t.next=9;break;case 8:throw new Error("Can't transit to target");case 9:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}()},{key:"_emit",value:function(){var t=s(regeneratorRuntime.mark(function t(e){var r,n,o,i,a=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("function"!=typeof this.events[e]){t.next=4;break}for(n=a.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=a[i];return t.next=4,(r=this.events)[e].apply(r,u(o));case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"can",value:function(t){var e=this;return!!this.schema.find(function(r){var n="string"==typeof r.from?r.from===e.state:r.from.includes(e.state),o=r.to===t;return n&&o})}},{key:"is",value:function(t){return this.state===t}},{key:"reset",value:function(){this.state=this.initial}},{key:"state",get:function(){return this._state},set:function(t){this._state=t}}]),t}()).prototype,"_transit",[e],Object.getOwnPropertyDescriptor(l.prototype,"_transit"),l.prototype),c(l.prototype,"_emit",[r],Object.getOwnPropertyDescriptor(l.prototype,"_emit"),l.prototype),c(l.prototype,"can",[n],Object.getOwnPropertyDescriptor(l.prototype,"can"),l.prototype),c(l.prototype,"is",[i],Object.getOwnPropertyDescriptor(l.prototype,"is"),l.prototype),c(l.prototype,"reset",[f],Object.getOwnPropertyDescriptor(l.prototype,"reset"),l.prototype),p=l))||p)}}])});